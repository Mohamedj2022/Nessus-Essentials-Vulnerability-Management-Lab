<h1>Nessus Essentials Vulnerability Management Lab</h1>

<h2>Description</h2>
This is a step-by-step guide on setting up a virtual machine environment using VMWare to run Windows 10. The purpose of this project is to gain hands-on experience with Nessus Essentials, a vulnerability scanner, and learn how to scan for and remediate vulnerabilities. The project focuses on two crucial steps in the Vulnerability Management Lifecycle. By using Nessus Essentials, we will scan local virtual machines hosted on VMWare Workstation, run credentialed scans to uncover vulnerabilities, fix some of the issues, and then perform another scan to confirm the remediation.
<br />

## Blog

Here is my blog post about Vulnerability Management and Scanners for more info:

https://medium.com/@mojmdevo/vulnerability-management-and-scanners-what-is-that-Ô∏è-ebea70cb7d78

<h2>Utilities Used</h2>

- <b>Nessus Essentials</b> 
- <b>CMD</b>

<h2>Environments Used </h2>

- <b>VMWare</b>
- <b>Windows 10</b> (21H2)

<h2>Links</h2>

- <b>VMWare Workstation Pro:</b> https://www.vmware.com/products/workstation-player/workstation-player-evaluation.html
- <b>Nessus Essentials:</b> https://www.tenable.com/products/nessus/nessus-essentials
- <b>Windows 10 ISO:</b> https://www.microsoft.com/en-us/software-download/windows10

<h2 align="center">Program walk-through</h2>

<p align="center">
<b>To begin, I will download Nessus Essentials, which is my vulnerability management software. While it downloads, I can make productive use of my time by downloading and configuring Windows 10 on a virtual machine, which can also be a time-consuming process.</b> <br/>
</p>

![Downloading Nessus](https://user-images.githubusercontent.com/108043108/177885108-9e637032-e965-4ecb-8166-b6931dc2dcff.JPG)

<br />
<br />
<p align="center">
<b>To ensure that my Virtual Machine is on the same network as my native machine, I configure the network adapter to be bridged. This allows Nessus to perform a Secure Server Login (SSL) into the Virtual Machine more easily.</b> <br/>
</p>

![Configure_Network_Adapters](https://user-images.githubusercontent.com/108043108/177885541-29039f1c-6217-43b4-92ca-86a60d092d3b.JPG)

<br />
<br />
<p align="center">
<b>At this stage, Nessus is still downloading and I have successfully downloaded Windows 10 on the Virtual Machine named "Admin". To be able to run vulnerability scans on Nessus, I need to figure out the IP address of the Virtual Machine. So, I open up CMD and use command prompt to find the IP address which is 192.168.50.185 as shown in the screenshot.</b> <br/>
</p>

![VM_IP](https://user-images.githubusercontent.com/108043108/177885744-426519f2-bd27-406c-a6eb-f71ef5a6bdcb.JPG)

<br />
<br />
<p align="center">
<b>As shown in the screenshot, I attempt to ping the VM from my native computer to test if I can establish communication with the VM. This step is crucial since if I am unable to ping the VM, Nessus won't be able to do so either, rendering it impossible to run scans. Unfortunately, the pings are timing out, indicating that my native PC is currently unable to connect with the VM.</b> <br/>
</p>

![trying_to_ping_VM_Fails](https://user-images.githubusercontent.com/108043108/177886078-cec7b98b-60da-47a6-8e70-838a649a456f.JPG)

<br />
<br />
<p align="center">
<b>I disable the firewalls on the VM to allow my native PC to establish a connection with it. However, it is important to note that in a production environment, disabling firewalls is not recommended as it could leave the system vulnerable to attacks.</b> <br/>
</p>

![windows_firewall_disable](https://user-images.githubusercontent.com/108043108/177886413-df1ba042-8e42-4ff6-a004-0057ac793cd1.JPG)

<br />
<br />
<p align="center">
<b>To disable the firewalls, I click on each of the firewall names (Windows Defender Firewall, Domain network firewall, and Public network firewall) and then click the "Turn Windows Defender Firewall on or off" link on the left side of the screen. This opens up the "Customize Settings" window where I can turn off the firewall for each type of network (Domain, Private, and Public). I select "Turn off Windows Defender Firewall (not recommended)" for each type of network and click "OK" to save the changes.</b> <br/>
</p>

![Turning_off_Firewalls](https://user-images.githubusercontent.com/108043108/177886437-e6b4addf-99e3-455f-b46f-c3941a433109.JPG)

<br />
<br />
<p align="center">
<b>After disabling the firewall on the VM, I attempted to ping it from my native PC once again and this time the ping was successful.</b> <br/>
</p>

![Ping_works](https://user-images.githubusercontent.com/108043108/177887412-f8078e7b-13a3-4480-b000-5ae84108cfab.JPG)

<br />
<br />
<p align="center">
<b>Once Nessus Essentials is downloaded, the first step is to create a new scan and then select the Basic Network Scan option.</b> <br/>
</p>

![Create_New_Scan](https://user-images.githubusercontent.com/108043108/177887661-793476e8-7e68-4c21-8983-8f955d7cff2e.JPG)

![basic_network_scan](https://user-images.githubusercontent.com/108043108/177887672-2d955508-edf1-4735-b78a-2836a81d2c9f.JPG)


<br />
<br />
<p align="center">
<b>After configuring the scan to target the VM's IP address, I select the type of scan to run. In this case, I choose a "Credential" scan as it allows Nessus to log in to the VM using the credentials provided and run a more thorough scan. I enter the VM's login credentials to proceed.</b> <br/>
</p>

![Scan_VM_IP](https://user-images.githubusercontent.com/108043108/177887914-87a2da10-be51-481c-a672-ec1104e3df7a.JPG)

<br />
<br />
<p align="center">
<b>After creating the scan and configuring it to target the VM's IP address, I launched the scan and it started working right away to detect any vulnerabilities. As the scan progressed, a grey checkmark appeared indicating that it had completed successfully</b> <br/>
</p>

![Launch_newly_created_scan](https://user-images.githubusercontent.com/108043108/177888041-95c53001-b8d2-4355-9311-3ee2637dff94.JPG)

![Scan_Running](https://user-images.githubusercontent.com/108043108/177888049-661dddfc-ebe0-42cf-ad87-14bc5af53fe5.gif)

![Scan_Completed](https://user-images.githubusercontent.com/108043108/177888068-25d4a86a-c150-4e77-a993-9df4178c5ba1.JPG)

<br />
<br />
<p align="center">
<b>Let's take a look at the scan results! The scan has detected a total of 33 issues, but 32 of them are marked as "info," meaning they are not actual vulnerabilities, but rather informational findings. The remaining issue is marked as "low," which indicates a relatively low severity vulnerability. In a real-world scenario, these info findings would probably not be acted upon, as they may be due to lack of proper credentials or other benign causes. The low severity issue would still require attention and remediation though.</b> <br/>
</p>

![Results_Of_Scan](https://user-images.githubusercontent.com/108043108/177888196-3141c52f-df79-4c58-9fee-5daa68d78c5b.gif)

<br />
<br />
<p align="center">
<b>One of the INFO results indicates that the Target Credential Status By Authentication Protocol was triggered. This happened because we didn't provide any credentials for the scan, and therefore the scan couldn't authenticate with the target system.</b> <br/>
</p>

![No_credentials_Given](https://user-images.githubusercontent.com/108043108/177888648-5679c8c1-e8ce-47e3-a424-067375964054.JPG)

<br />
<br />
<p align="center">
<b>I proceed to set up the VM to allow authenticated scans and furnish Nessus with the required credentials. To achieve this, I head to the services.MSC and activate Remote Registry. This step is crucial in enabling Nessus to connect to the VM's registry and scan it for vulnerabilities like insecure connections or deprecated cipher suites. Although there might be better approaches to carrying out credentialed scans, I follow the steps outlined by Nessus as it is their recommended approach.
</b> <br/>
</p>

![Services_MSC](https://user-images.githubusercontent.com/108043108/177888931-9dbd1224-5155-4129-ba09-4f495976a0e2.JPG)

![Enabling_Remote_Registry](https://user-images.githubusercontent.com/108043108/177889042-0a885e18-bf64-4390-8f43-454bdaf79004.gif)

<br />
<br />
<p align="center">
<b>Next, I navigate to User Account Controls and disable it. This step is necessary because the VM is not part of a domain, so I have to take some non-standard steps to make it work properly. However, it is important to note that in a real organization or production environment, this is not a recommended practice.</b> <br/>
</p>

![user_account_Settings](https://user-images.githubusercontent.com/108043108/177889466-907890fc-e67e-490b-8a17-b335263d0359.JPG)

![User_Account_settings_configuration](https://user-images.githubusercontent.com/108043108/177889473-ba988135-ce62-4717-bf04-1e426ec8c4b6.gif)

<br />
<br />
<p align="center">
<b>After disabling User Account Controls, the next step is to open the registry and add a key that should enable Nessus to connect by further reducing the restrictions imposed by UAC.</b> <br/>
</p>

![Registry_editor](https://user-images.githubusercontent.com/108043108/177889663-24088363-2291-4af0-8ea9-6f6486fc82ad.JPG)

<br />
<br />
<p align="center">
<b>After navigating to the Registry file recommended by Nessus (highlighted in yellow in the search bar), I add a DWORD value named LocalAccountTokenFilterPolicy and set its value to 1. This change is expected to allow Nessus to connect by further disabling User Account Control.</b> <br/>
</p>

![Creating_a_new_DWORD](https://user-images.githubusercontent.com/108043108/177889894-f94747fa-fa05-401f-82d4-1c9ec9faa57f.JPG)

![DWORD_name](https://user-images.githubusercontent.com/108043108/177889904-aa294428-0864-4018-8cb5-b61da5e65478.JPG)

![Edit_DWORD](https://user-images.githubusercontent.com/108043108/177889915-70e9814c-5167-460c-be85-10abf056fd8f.JPG)

<br />
<br />
<p align="center">
<b>After doing that I have to restart the VM so the changes can take effect.</b> <br/>
</p>

![Restart_The_VM](https://user-images.githubusercontent.com/108043108/177889955-2511a00a-9b59-4b4d-a9be-c2abda9869a6.JPG)

<br />
<br />
<p align="center">
<b>After configuring the registry, I proceed to adjust the scan settings in Nessus. In particular, I need to add the necessary credentials to the scan configuration for it to work properly. This means providing the username and password of the VM to Nessus so that it can use them to access areas of the VM's registry where they are needed.</b> <br/>
</p>

![Configure_Nessus](https://user-images.githubusercontent.com/108043108/177890138-e6420231-4ce8-4a2d-99fb-e1e992da6ebb.JPG)

![Adding_Credentials](https://user-images.githubusercontent.com/108043108/177890151-27496a20-72b8-4763-8c82-368a06a15d3f.gif)

<br />
<br />
<p align="center">
<b>After the scan is properly configured with the right credentials, I run it again.</b> <br/>
</p>

![Run_The_Scan_Again](https://user-images.githubusercontent.com/108043108/177890377-b412d84a-d8e2-40da-9995-dddbd3c4d388.JPG)

<br />
<br />
<p align="center">
<b>The latest scan using credentials has revealed a much larger number of vulnerabilities compared to the first scan without credentials. The image on top shows the results of the new scan while the one at the bottom is from the initial non-credentialed scan. The significant increase in vulnerabilities is likely because the version of Windows 10 running on the VM is outdated and needs updating.</b> <br/>
</p>

![new_scan_properly_credentialed](https://user-images.githubusercontent.com/108043108/177890582-7f4d0eec-3b5f-4a5f-b708-47b3ccfb5d83.JPG)

![Old_scan_not_credentialed](https://user-images.githubusercontent.com/108043108/177890589-e4e882ab-6733-4930-ad4c-1115a2c620b3.JPG)

<br />
<br />
<p align="center">
<b>I am curious about the capabilities of Nessus Scanner, so I plan to download an old version of Firefox that is likely to have numerous vulnerabilities. I am confident that Nessus Scanner will be able to detect these vulnerabilities.</b><br/>
</p>

![downloading_an_old_version_of_firefox](https://user-images.githubusercontent.com/108043108/177890787-5cd80be3-99a1-40a4-bddc-feb06ea9cda7.JPG)

<br />
<br />
<p align="center">
<b>After downloading an outdated version of Firefox, I initiated another scan using Nessus. As expected, the scan resulted in numerous alerts and vulnerabilities, with as many as 68 being critical. This demonstrates the power of Nessus in identifying and flagging potential vulnerabilities in outdated software.</b> <br/>
</p>

![Old_Firefox_Scan](https://user-images.githubusercontent.com/108043108/177890872-ed890db9-a15d-4de9-b3b3-6723dd161f22.JPG)

<br />
<br />
<p align="center">
<b>A comparison between scans to show the progression of alerts and vulnerabilities.</b>  <br/>
</p>

![Vulnerability_Comparison](https://user-images.githubusercontent.com/108043108/177890918-c2fc7078-34b9-4120-a430-f096169ae177.jpg)

<br />
<br />
<p align="center">
<b>In the scan results, it is evident that most of the critical alerts are from the outdated version of Firefox that was downloaded. Remediation options include updating Firefox to a newer version, which may address several vulnerabilities, or uninstalling Firefox altogether.</b>  <br/>
</p>

![Showing_Vulnerabilities](https://user-images.githubusercontent.com/108043108/177891162-cf86e335-0539-4f9f-abb2-7150b482e689.gif)

<br />
<br />
<p align="center">
<b>To start the process of remediating vulnerabilities, I elect to just delete Firefox. That will instantly fix a lot of these issues.</b>  <br/>
</p>

![Fixing_Vulnerabilities_Uninstall_Firefox](https://user-images.githubusercontent.com/108043108/177891363-17bdc0ea-c872-434f-95a6-4bf6e4694ddf.JPG)

<br />
<br />
<p align="center">
<b>To fix the vulnerabilities found in Windows, I decide to update the operating system. Since the version of Windows on the VM is outdated, it requires several restarts to complete the update process.</b>  <br/>
</p>

![Remediating_Vulnerabilities_Updating_WIndows_1](https://user-images.githubusercontent.com/108043108/177891464-75d2b603-cadf-4923-bc1f-61409b11169d.gif)

![Remediating_Vulnerabilities_Updating_Windows](https://user-images.githubusercontent.com/108043108/177891436-a7b26e21-8376-4650-aaee-aaf4bc2e451e.JPG)

<br />
<br />
<p align="center">
<b>After the Windows updates and removing Firefox, you run another Nessus scan to see if the vulnerabilities have been remediated. The scan results show a significant decrease in the number of vulnerabilities, with only a few remaining. This indicates that the steps taken to update Windows and remove Firefox were effective in reducing the number of vulnerabilities.</b>  <br/>
</p>

![VM_Up_To_date](https://user-images.githubusercontent.com/108043108/177891501-767d6764-8e4a-4bd0-85cc-6b70e48c62aa.JPG)

<br />
<br />
<p align="center">
<b>The four Nessus scans that were performed during the lab are compared in the final picture. The fourth scan, which was conducted after remediation steps were taken, shows a significant reduction in the number of vulnerabilities. Most of the previously detected issues have been resolved, leaving only one critical vulnerability that can be addressed in the future.</b>  <br/>
</p>

![After_Vulnerability_Remediation](https://user-images.githubusercontent.com/108043108/177891719-3066c9bb-38dd-4b10-b8bb-6f9dd8a45a09.JPG)

<br />
<br />


<!--
 ```diff
- text in red
+ text in green
! text in orange
# text in gray
@@ text in purple (and bold)@@
```
--!>
